# 飞控源码

## 基本外设
+ 5050RGB灯珠：信息量大，**不用5V也可以亮**
+ mpu6050：最重要。但没有磁力计时解算yaw轴角度会偏离，因此在yaw的控制中只使用了单环
+ SI24R1：2.4G无线通信，配置对就没有什么大问题
## 串级PID控制
pitch与roll使用串级，yaw使用单级
## 动力分配
根据电机给力的方向运动分解即可，不困难
# 遥控器源码

## 按键与遥感
![[Pasted image 20231218205737.png]]

使用时：
+ 首先将油门拉到底，然后按K1
+ 按键校准

# 问题记录
12.29
+ 软件：
	+ S124R1收发地址在遥控器中需要保持与一致

+ 硬件
	+ 飞控
		+ 歪歪扭扭的排针，不能用的电源开关，去掉的boost而直接用battery代替5V......这个板子还能用已经是奇迹了
		+ mpu6050焊接需要回流焊，难度较高
		+ 遥控接收的排针与排母松动，在飞机有较大位姿晃动时容易断连
		+ 两个电机给PWM（软件与硬件均确认）之后不转，测量MOS栅极有正常的导通电压，但是电机不转的两端没有电压。测量MOS附近的连通性没有问题。通过飞线连接转与不转的电机也不能解决问题。

1.7
遥控OK
但yaw，pitch，roll的传递值不对，有一个莫名其妙的ADC_calibration，于是重写

但感觉飞机的动力分配不对，飞不起来，还需要研究一下。

1.12
发现原来是桨叶安反了
现在的现象是只写油门，加大马力之后会稳定右翻，也对应了之前稳定右翻加自选的现象。准备调参试试